# This file contains curated Splunk data models for the SIEM agent.
# It helps the agent understand which indexes and fields to use for specific analysis tasks.

pan_logs:
  description: "Palo Alto Networks Firewall Traffic Logs. Use this for analyzing network connections (e.g., traffic between IPs, port usage, allowed/denied actions)."
  sourcetype: "pan:traffic"
  key_fields: ["action", "src_ip", "src_port", "dest_ip", "dest_port", "proto", "app", "rule", "bytes_in", "bytes_out"]

windows_security:
  description: "Windows Security Event Logs. Use this for host-level activity analysis."
  sourcetype: "WinEventLog:Security"
  key_fields: ["EventCode", "ComputerName", "SubjectUserName", "TargetUserName", "ProcessName", "ParentProcessName", "CommandLine", "LogonType", "IpAddress"]
  notes: |
    Common Event Codes:
    - 4624: Successful logon
    - 4625: Failed logon
    - 4688: Process creation
    - 4768/4769: Kerberos authentication
    - 5140: A network share object was accessed.

zeek:
  description: "Zeek Network Security Monitor logs. Provides detailed records of network activity. Use for deep network analysis, file extraction, or protocol-specific queries."
  sourcetype: "zeek:conn"
  key_fields: ["uid", "id_orig_h", "id_orig_p", "id_resp_h", "id_resp_p", "proto", "service", "duration", "orig_bytes", "resp_bytes", "conn_state"]

cloudtrail:
  description: "AWS CloudTrail logs. Audits API calls and user activity within an AWS environment. Use for investigating suspicious cloud actions like unauthorized user creation or permission changes."
  sourcetype: "aws:cloudtrail"
  key_fields: ["eventSource", "eventName", "userIdentity.type", "userIdentity.userName", "sourceIPAddress", "userAgent", "requestParameters", "responseElements", "errorCode", "awsRegion"]
